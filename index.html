<!--
Pixel Shuffler - Sand Layers + Vertical Shift
Version: 0.10.1

Changelog:
- 0.10.1
  - Removed reliance on the Apply button being disabled/enabled.
    Apply is now always clickable; we guard with a runtime check to ensure
    an image is loaded before processing. This avoids cases where the button
    could remain greyed out due to script or load issues.
- 0.10.0
  - Added "Vertical Shift" mode:
      * Columns processed in horizontal blocks of size X (user-defined).
      * Blocks alternate: UP by X, DOWN by X (vertical wrap).
      * Pure pixel rearrangement, no creation/removal.
- 0.9.1
  - Brightness-only sorting in Sand Layout mode.
- 0.9.0
  - Mound-shaped layout for Sand Layout mode.
-->

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Pixel Shuffler MVP</title>
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #111;
      color: #f5f5f5;
      margin: 0;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 20px;
    }

    h1 {
      margin: 0;
      font-size: 1.6rem;
      display: flex;
      align-items: baseline;
      gap: 8px;
    }

    .version-inline {
      font-size: 0.85rem;
      opacity: 0.7;
    }

    .app {
      max-width: 1000px;
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 16px;
    }

    .controls {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      align-items: center;
      background: #1b1b1b;
      padding: 10px 12px;
      border-radius: 8px;
    }

    .controls label {
      font-size: 0.9rem;
      opacity: 0.9;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    input[type="file"] {
      font-size: 0.9rem;
    }

    select, button, input[type="number"] {
      background: #222;
      color: #f5f5f5;
      border: 1px solid #444;
      border-radius: 6px;
      padding: 6px 10px;
      font-size: 0.9rem;
      cursor: pointer;
    }

    button:hover {
      background: #333;
    }

    input[type="number"] {
      width: 70px;
    }

    .canvases {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(260px, 1fr));
      gap: 16px;
      align-items: flex-start;
    }

    .canvas-wrapper {
      background: #1b1b1b;
      border-radius: 8px;
      padding: 10px;
    }

    .canvas-wrapper h2 {
      font-size: 0.95rem;
      margin: 0 0 8px 0;
      opacity: 0.85;
    }

    canvas {
      max-width: 100%;
      border-radius: 4px;
      background: #000;
      display: block;
    }

    .status {
      font-size: 0.9rem;
      opacity: 0.8;
      min-height: 1.2em;
    }

    .footer {
      font-size: 0.8rem;
      opacity: 0.7;
      margin-top: 10px;
      display: flex;
      gap: 8px;
      align-items: baseline;
      justify-content: space-between;
      width: 100%;
      max-width: 1000px;
    }
  </style>
</head>
<body>
  <div class="app">
    <h1>
      Pixel Shuffler
      <span class="version-inline js-version-inline"></span>
    </h1>

    <div class="controls">
      <label>
        Image:
        <input type="file" id="fileInput" accept="image/*" />
      </label>

      <label>
        Mode:
        <select id="modeSelect">
          <option value="sand">Sand Layout</option>
          <option value="verticalShift">Vertical Shift</option>
        </select>
      </label>

      <label id="moundsLabel">
        Mounds:
        <select id="moundsSelect">
          <option value="1">1</option>
          <option value="2" selected>2</option>
          <option value="3">3</option>
          <option value="4">4</option>
          <option value="5">5</option>
          <option value="6">6</option>
        </select>
      </label>

      <label id="shiftLabel" style="display:none;">
        Shift size (px):
        <input type="number" id="shiftSizeInput" min="1" max="500" value="20" />
      </label>

      <button id="applyBtn">Apply</button>
      <button id="downloadBtn" disabled>Download Result</button>

      <span class="status" id="statusText"></span>
    </div>

    <div class="canvases">
      <div class="canvas-wrapper">
        <h2>Original</h2>
        <canvas id="originalCanvas"></canvas>
      </div>
      <div class="canvas-wrapper">
        <h2>Output</h2>
        <canvas id="outputCanvas"></canvas>
      </div>
    </div>
  </div>

  <div class="footer">
    <span>Select a mode, tweak parameters, and click "Apply".</span>
    <span>Version: <span class="js-version-footer"></span></span>
  </div>

  <script>
